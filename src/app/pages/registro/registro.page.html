<ion-content class="registro-content">
  <div class="form-container">
    <div class="top-spacer"></div>
    <h1 class="title">Registro</h1>
    <p class="subtitle">ğŸ‰ Â¡Vamos a conocerte a ti y a tu perrito!</p>

    <!-- ğŸ¶ Avatar con badge + -->
    <div class="avatar-wrap">
      <div class="avatar-box">
        <ion-avatar class="avatar-xl" *ngIf="photoDataUrl; else emptyAvatar">
          <img [src]="photoDataUrl" alt="Foto del peludito" />
        </ion-avatar>

        <ng-template #emptyAvatar>
          <ion-avatar class="avatar-xl placeholder">
            <ion-icon name="person-outline"></ion-icon>
          </ion-avatar>
        </ng-template>

        <!-- CÃ­rculo verde con "+" -->
        <button type="button" class="add-badge" (click)="triggerFilePicker(fileInput)">+</button>
      </div>

      <input type="file" accept="image/*" #fileInput hidden (change)="onFileSelected($event)" />
      <!-- âŒ Ya no mostramos error de foto obligatoria -->
    </div>

    <!-- ğŸ“‹ FORM -->
    <form [formGroup]="form" (ngSubmit)="onSubmit()" novalidate>

      <!-- ğŸ‘¦ NiÃ±o -->
      <ion-item lines="none" class="field">
        <ion-label position="stacked" class="q-label">Â¿CÃ³mo te llamas, pequeÃ±o cuidador?</ion-label>
        <div class="control-box">
          <ion-input
            formControlName="nombreNino"
            type="text"
            placeholder="Escribe tu nombre">
          </ion-input>
        </div>
      </ion-item>
      <div class="error" *ngIf="form?.get('nombreNino')?.invalid && form?.get('nombreNino')?.touched">
        âœï¸ Este campo es obligatorio
      </div>

      <!-- ğŸ• Perrito -->
      <ion-item lines="none" class="field">
        <ion-label position="stacked" class="q-label">Â¿CÃ³mo se llama tu peludito? ğŸ•</ion-label>
        <div class="control-box">
          <ion-input
            formControlName="nombrePerro"
            type="text"
            placeholder="Nombre de tu perrito">
          </ion-input>
        </div>
      </ion-item>
      <div class="error" *ngIf="form?.get('nombrePerro')?.invalid && form?.get('nombrePerro')?.touched">
        ğŸ¾ Escribe el nombre de tu perrito
      </div>

      <!-- âš–ï¸ Peso -->
      <ion-item lines="none" class="field">
        <ion-label position="stacked" class="q-label">Â¿Y cuÃ¡nto pesa? ğŸ¾ (en kilogramos)</ion-label>
        <div class="control-box">
          <ion-select
            interface="popover"
            placeholder="Elige el peso"
            formControlName="peso">
            <ion-select-option *ngFor="let p of pesos" [value]="p">{{ p }}</ion-select-option>
          </ion-select>
        </div>
      </ion-item>
      <div class="error" *ngIf="form?.get('peso')?.invalid && form?.get('peso')?.touched">
        âš–ï¸ Selecciona el peso de tu perrito
      </div>

      <!-- ğŸ© Raza -->
      <ion-item lines="none" class="field">
        <ion-label position="stacked" class="q-label">Â¿QuÃ© raza es tu perrito? ğŸ¶</ion-label>
        <div class="control-box">
          <ion-select
            interface="popover"
            placeholder="Elige la raza"
            formControlName="raza">
            <ion-select-option *ngFor="let r of razas" [value]="r">{{ r }}</ion-select-option>
          </ion-select>
        </div>
      </ion-item>
      <div class="error" *ngIf="form?.get('raza')?.invalid && form?.get('raza')?.touched">
        ğŸ•â€ğŸ¦º Debes seleccionar una raza
      </div>

      <!-- ğŸ‚ Edad -->
      <ion-item lines="none" class="field">
        <ion-label position="stacked" class="q-label">Â¿QuÃ© edad tiene tu peludito? (En aÃ±os humanos)</ion-label>
        <div class="control-box">
          <ion-select
            interface="popover"
            placeholder="Elige edad"
            formControlName="edad">
            <ion-select-option *ngFor="let e of edades" [value]="e">{{ e }}</ion-select-option>
          </ion-select>
        </div>
      </ion-item>
      <div class="error" *ngIf="form?.get('edad')?.invalid && form?.get('edad')?.touched">
        ğŸ‚ Indica la edad de tu peludito
      </div>

      <!-- ğŸ“§ Correo -->
      <ion-item lines="none" class="field">
        <ion-label position="stacked" class="q-label">Correo de tu adulto responsable ğŸ“§</ion-label>
        <div class="control-box">
          <ion-input
            formControlName="correoAdulto"
            type="email"
            placeholder="nombre@dominio.com">
          </ion-input>
        </div>
      </ion-item>
      <div class="error" *ngIf="form?.get('correoAdulto')?.touched && form?.get('correoAdulto')?.invalid">
        <ng-container *ngIf="form?.get('correoAdulto')?.hasError('required')">
          ğŸ“© Este campo es obligatorio
        </ng-container>
        <ng-container *ngIf="form?.get('correoAdulto')?.hasError('pattern')">
          âš ï¸ El correo no tiene un formato vÃ¡lido (ejemplo: nombre@dominio.com)
        </ng-container>
      </div>

      <!-- ğŸŒŸ Espacio antes del botÃ³n -->
      <div class="spacer"></div>

      <!-- ğŸŸ  BotÃ³n CTA -->
      <div class="cta-wrap">
        <ion-button type="submit" class="cta" [disabled]="!form || form.invalid">
          Registrarse
        </ion-button>
      </div>
    </form>
  </div>
</ion-content>
